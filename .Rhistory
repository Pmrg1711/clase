install.packages("inti")
pkgbuild::has_build_tools(debug = TRUE)
inti:::scihub()
load("C:/Users/pmrg1/OneDrive/Desktop/git/lab_heritability.qmd")
#| label: setup
#| include: false
source("https://inkaverse.com/docs.r")
knitr::opts_chunk$set(echo = T)
cran <- c("inti"
, "metan"
, "psych"
, "FactoMineR"
, "openxlsx"
, "cowplot"
)
suppressPackageStartupMessages({
for (pkgs in cran) {
if( !require(pkgs, character.only = T) ) {
install.packages(pkgs)
library(pkgs, character.only = T)
}
}
remove(cran, pkgs)
})
fb <- data_ge2
# ?data_ge2
fb %>% web_table()
#| eval: false
str(fb)
openxlsx::write.xlsx(x = fb, file = "met.xlsx")
getwd()
# browseURL("https://wilkelab.org/cowplot/articles/mixing_plot_frameworks.html")
png(filename = "correlation.png", width = 25, height = 25, units = "cm", res = 300)
fb %>%
select(where(is.numeric))  %>%
pairs.panels(hist.col="red"
, pch = 21
, method = "pearson"
, stars = T
, scale = T
, lm = T
)
graphics.off()
include_graphics("correlation.png")
mv <- fb %>%
group_by(GEN) %>%
summarise(across(where(is.numeric)
, ~ mean(.x, na.rm = TRUE))) %>%
column_to_rownames("GEN") %>%
PCA(X = .
, scale.unit = T
, graph = F
)
plot1 <- plot.PCA(mv
, choix = "var")
plot1
plot2 <- plot.PCA(mv
, choix = "ind"
, cex = 0.8
, shadowtext = T
, label = "ind"
, autoLab = "yes"
, graph.type = "ggplot"
)
plot2
plot2 <- plot.PCA(mv
, choix = "ind"
, cex = 0.8
, shadowtext = T
, label = "ind"
, autoLab = "yes"
, graph.type = "ggplot"
)
plot2
list(plot1, plot2) %>%
plot_grid(plotlist = .
, nrow = 1
, labels = "AUTO"
, rel_widths = c(1, 1.5)
)
hr <- H2cal(data = fb
, trait = "KW"
, gen.name = "GEN"
, rep.n = 3
, env.name = "ENV"
, env.n = 4
, fixed.model = "0 + (1|REP) + (1|ENV) + GEN"
, random.model = "1 + (1|REP) + (1|ENV) + (1|GEN)"
, emmeans = TRUE
, plot_diag = TRUE
, outliers.rm = FALSE
)
hr$model %>% summary()
hr$tabsmr %>% web_table()
hr$blups %>%
arrange(desc(KW)) %>%
kable()
hr <- H2cal(data = fb
, trait = "PH"
, gen.name = "GEN"
, rep.n = 3
, env.name = "ENV"
, env.n = 4
, fixed.model = "0 + (1|REP) + (1|ENV) + (1|ENV:GEN) + GEN"
, random.model = "1 + (1|REP) + (1|ENV) + (1|ENV:GEN) + (1|GEN)"
, emmeans = TRUE
, plot_diag = TRUE
, outliers.rm = TRUE
)
hr$model %>% summary()
hr$tabsmr %>% web_table()
hr$blups %>%
arrange(desc(PH))
kable()
#| eval: false
browseURL("https://docs.google.com/spreadsheets/d/15r7ZwcZZHbEgltlF6gSFvCTFA-CFzVBWwg3mFlRyKPs/edit#gid=1263018298")
